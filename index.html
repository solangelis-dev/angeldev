<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haven - License Management System</title>
    <meta name="description" content="Powered By Haven Services">
    <meta name="author" content="Haven">
    
    <meta property="og:title" content="Haven - License Management System">
    <meta property="og:description" content="Powered By Haven Services">
    <meta property="og:type" content="website">
    
    <meta name="twitter:card" content="summary_large_image">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        border: 'hsl(214.3 31.8% 91.4%)',
                        input: 'hsl(214.3 31.8% 91.4%)',
                        ring: 'hsl(262.1 83.3% 57.8%)',
                        background: 'hsl(0 0% 100%)',
                        foreground: 'hsl(224 71.4% 4.1%)',
                        primary: {
                            DEFAULT: 'hsl(262.1 83.3% 57.8%)',
                            foreground: 'hsl(210 40% 98%)',
                        },
                        secondary: {
                            DEFAULT: 'hsl(220 14.3% 95.9%)',
                            foreground: 'hsl(220.9 39.3% 11%)',
                        },
                        destructive: {
                            DEFAULT: 'hsl(0 84.2% 60.2%)',
                            foreground: 'hsl(210 40% 98%)',
                        },
                        muted: {
                            DEFAULT: 'hsl(220 14.3% 95.9%)',
                            foreground: 'hsl(220 8.9% 46.1%)',
                        },
                        accent: {
                            DEFAULT: 'hsl(220 14.3% 95.9%)',
                            foreground: 'hsl(220.9 39.3% 11%)',
                        },
                        card: {
                            DEFAULT: 'hsl(0 0% 100%)',
                            foreground: 'hsl(224 71.4% 4.1%)',
                        },
                    },
                    borderRadius: {
                        lg: '0.5rem',
                        md: 'calc(0.5rem - 2px)',
                        sm: 'calc(0.5rem - 4px)',
                    },
                }
            }
        }
    </script>
    <style>
        .dark {
            --background: 224 71.4% 4.1%;
            --foreground: 210 40% 98%;
            --card: 224 71.4% 4.1%;
            --card-foreground: 210 40% 98%;
            --primary: 262.1 83.3% 57.8%;
            --primary-foreground: 210 40% 98%;
            --secondary: 215 27.9% 16.9%;
            --secondary-foreground: 210 40% 98%;
            --muted: 215 27.9% 16.9%;
            --muted-foreground: 217.9 10.6% 64.9%;
            --accent: 215 27.9% 16.9%;
            --accent-foreground: 210 40% 98%;
            --destructive: 0 62.8% 30.6%;
            --destructive-foreground: 210 40% 98%;
            --border: 215 27.9% 16.9%;
            --input: 215 27.9% 16.9%;
            --ring: 262.1 83.3% 57.8%;
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .key-display {
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }
        
        .tooltip {
            position: relative;
        }
        
        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: hsl(262.1 83.3% 57.8%);
            color: hsl(210 40% 98%);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
        }

        .purple-gradient {
            background: linear-gradient(135deg, hsl(262.1 83.3% 57.8%) 0%, hsl(283 100% 60%) 100%);
        }

        .status-unused {
            color: hsl(43 96% 56%);
        }

        .status-active {
            color: hsl(142 76% 36%);
        }

        .status-expired {
            color: hsl(0 84% 60%);
        }
    </style>
</head>
<body class="min-h-screen bg-background text-foreground">
    <div class="container mx-auto p-6">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-primary mb-2">Haven</h1>
            <p class="text-muted-foreground">Powered By Haven Services</p>
        </header>

        <!-- Main Dashboard -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Generate Key Section -->
            <div class="lg:col-span-2">
                <div class="bg-card border rounded-lg p-6 shadow-sm">
                    <h2 class="text-2xl font-semibold mb-4">Generate License Key</h2>
                    
                    <!-- Duration Selection -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">Key Duration</label>
                        <select id="duration" class="w-full p-3 border border-input rounded-md bg-background focus:outline-none focus:ring-2 focus:ring-ring">
                            <option value="1">1 Day</option>
                            <option value="3">3 Days</option>
                            <option value="7">1 Week</option>
                            <option value="30">1 Month</option>
                            <option value="365">1 Year</option>
                        </select>
                    </div>

                    <!-- Prefix Input -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">Key Prefix (Optional)</label>
                        <input 
                            type="text" 
                            id="prefix" 
                            placeholder="e.g., DAY, WEEK, MONTH"
                            class="w-full p-3 border border-input rounded-md bg-background focus:outline-none focus:ring-2 focus:ring-ring"
                            maxlength="10">
                        <p class="text-xs text-muted-foreground mt-1">Leave empty for random key generation</p>
                    </div>

                    <!-- Generate Button -->
                    <button 
                        id="generateBtn"
                        class="w-full purple-gradient text-white py-3 px-6 rounded-md font-medium hover:opacity-90 transition-opacity">
                        Generate License Key
                    </button>
                </div>
            </div>

            <!-- Generated Keys Display -->
            <div>
                <div class="bg-card border rounded-lg p-6 shadow-sm">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold">Generated Keys</h3>
                        <button 
                            id="removeAllBtn"
                            class="bg-destructive text-destructive-foreground py-1 px-3 rounded text-sm hover:bg-destructive/90 transition-colors">
                            Remove All
                        </button>
                    </div>
                    <div id="keysContainer" class="space-y-3">
                        <p class="text-muted-foreground text-center py-8">No keys generated yet</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- License Management Section -->
        <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Key Validation -->
            <div class="bg-card border rounded-lg p-6 shadow-sm">
                <h3 class="text-xl font-semibold mb-4">Validate License Key</h3>
                <div class="space-y-4">
                    <input 
                        type="text" 
                        id="validateKey" 
                        placeholder="Enter license key to validate"
                        class="w-full p-3 border border-input rounded-md bg-background focus:outline-none focus:ring-2 focus:ring-ring">
                    <button 
                        id="validateBtn"
                        class="w-full bg-secondary text-secondary-foreground py-2 px-4 rounded-md hover:bg-secondary/80 transition-colors">
                        Validate Key
                    </button>
                    <div id="validationResult" class="hidden p-3 rounded-md"></div>
                </div>
            </div>

            <!-- HWID Management -->
            <div class="bg-card border rounded-lg p-6 shadow-sm">
                <h3 class="text-xl font-semibold mb-4">HWID Management</h3>
                <div class="space-y-4">
                    <input 
                        type="text" 
                        id="hwidInput" 
                        placeholder="Enter HWID or License Key"
                        class="w-full p-3 border border-input rounded-md bg-background focus:outline-none focus:ring-2 focus:ring-ring">
                    <div class="grid grid-cols-2 gap-2">
                        <button 
                            id="resetHwidBtn"
                            class="bg-destructive text-destructive-foreground py-2 px-4 rounded-md hover:bg-destructive/90 transition-colors text-sm">
                            Reset HWID
                        </button>
                        <button 
                            id="checkHwidBtn"
                            class="bg-accent text-accent-foreground py-2 px-4 rounded-md hover:bg-accent/80 transition-colors text-sm">
                            Check HWID
                        </button>
                    </div>
                    <div id="hwidResult" class="hidden p-3 rounded-md text-sm"></div>
                </div>
            </div>
        </div>

        <!-- Statistics Section -->
        <div class="mt-8">
            <div class="bg-card border rounded-lg p-6 shadow-sm">
                <h3 class="text-xl font-semibold mb-4">System Statistics</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="text-center p-4 bg-secondary/20 rounded-lg">
                        <div class="text-2xl font-bold text-primary" id="totalKeys">0</div>
                        <div class="text-sm text-muted-foreground">Total Keys</div>
                    </div>
                    <div class="text-center p-4 bg-secondary/20 rounded-lg">
                        <div class="text-2xl font-bold status-active" id="activeKeys">0</div>
                        <div class="text-sm text-muted-foreground">Active Keys</div>
                    </div>
                    <div class="text-center p-4 bg-secondary/20 rounded-lg">
                        <div class="text-2xl font-bold status-expired" id="expiredKeys">0</div>
                        <div class="text-sm text-muted-foreground">Expired Keys</div>
                    </div>
                    <div class="text-center p-4 bg-secondary/20 rounded-lg">
                        <div class="text-2xl font-bold text-blue-600" id="hwidResets">0</div>
                        <div class="text-sm text-muted-foreground">HWID Resets</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-4 right-4 purple-gradient text-white p-4 rounded-md shadow-lg transform translate-x-full transition-transform duration-300 z-50">
        <div id="toastMessage"></div>
    </div>

    <script>
        // License Management System Logic
        class LicenseManager {
            constructor() {
                this.keys = JSON.parse(localStorage.getItem('licenseKeys')) || [];
                this.stats = JSON.parse(localStorage.getItem('licenseStats')) || {
                    totalKeys: 0,
                    activeKeys: 0,
                    expiredKeys: 0,
                    hwidResets: 0
                };
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateDisplay();
                this.updateStats();
            }

            setupEventListeners() {
                document.getElementById('generateBtn').addEventListener('click', () => this.generateKey());
                document.getElementById('validateBtn').addEventListener('click', () => this.validateKey());
                document.getElementById('resetHwidBtn').addEventListener('click', () => this.resetHWID());
                document.getElementById('checkHwidBtn').addEventListener('click', () => this.checkHWID());
                document.getElementById('removeAllBtn').addEventListener('click', () => this.removeAllKeys());
            }

            generateRandomKey() {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                let result = '';
                for (let i = 0; i < 4; i++) {
                    if (i > 0) result += '-';
                    for (let j = 0; j < 4; j++) {
                        result += chars.charAt(Math.floor(Math.random() * chars.length));
                    }
                }
                return result;
            }

            generateKey() {
                const duration = parseInt(document.getElementById('duration').value);
                const prefix = document.getElementById('prefix').value.trim().toUpperCase();
                
                let keyCode = this.generateRandomKey();
                if (prefix) {
                    keyCode = `${prefix}-${keyCode}`;
                }

                const now = new Date();
                
                const keyData = {
                    id: Date.now(),
                    key: keyCode,
                    duration: duration,
                    created: now.toISOString(),
                    status: 'unused',
                    hwid: null,
                    hwidResets: 0,
                    activatedAt: null,
                    expiresAt: null
                };

                this.keys.unshift(keyData);
                this.stats.totalKeys++;
                
                this.saveData();
                this.updateDisplay();
                this.updateStats();
                this.showToast(`Key generated successfully: ${keyCode}`);

                // Clear inputs
                document.getElementById('prefix').value = '';
            }

            validateKey() {
                const keyInput = document.getElementById('validateKey').value.trim();
                const resultDiv = document.getElementById('validationResult');
                
                if (!keyInput) {
                    this.showValidationResult('Please enter a license key', 'error');
                    return;
                }

                const keyData = this.keys.find(k => k.key === keyInput);
                
                if (!keyData) {
                    this.showValidationResult('Invalid license key', 'error');
                    return;
                }

                // Check if key is activated and expired
                if (keyData.status === 'active' && keyData.expiresAt) {
                    const now = new Date();
                    const expiry = new Date(keyData.expiresAt);
                    if (now > expiry) {
                        keyData.status = 'expired';
                        this.saveData();
                        this.updateStats();
                    }
                }

                let statusDisplay = keyData.status.toUpperCase();
                let statusClass = 'info';
                let additionalInfo = '';

                if (keyData.status === 'unused') {
                    statusClass = 'info';
                    additionalInfo = `Duration: ${keyData.duration} day(s)<br>Ready to activate`;
                } else if (keyData.status === 'active') {
                    statusClass = 'success';
                    const expiry = new Date(keyData.expiresAt);
                    const now = new Date();
                    const timeLeft = Math.max(0, expiry - now);
                    const daysLeft = Math.ceil(timeLeft / (1000 * 60 * 60 * 24));
                    additionalInfo = `Activated: ${new Date(keyData.activatedAt).toLocaleDateString()}<br>
                                     Expires: ${expiry.toLocaleDateString()}<br>
                                     Days Left: ${daysLeft}`;
                } else if (keyData.status === 'expired') {
                    statusClass = 'error';
                    additionalInfo = `Expired: ${new Date(keyData.expiresAt).toLocaleDateString()}`;
                }
                
                this.showValidationResult(
                    `Key Status: ${statusDisplay}<br>
                    Created: ${new Date(keyData.created).toLocaleDateString()}<br>
                    ${additionalInfo}<br>
                    HWID: ${keyData.hwid || 'Not bound'}<br>
                    HWID Resets: ${keyData.hwidResets}`,
                    statusClass
                );

                // Auto-hide after 4 seconds
                setTimeout(() => {
                    resultDiv.classList.add('hidden');
                }, 4000);
            }

            showValidationResult(message, type) {
                const resultDiv = document.getElementById('validationResult');
                let className = 'p-3 rounded-md ';
                
                if (type === 'success') {
                    className += 'bg-green-100 text-green-800 border border-green-200';
                } else if (type === 'error') {
                    className += 'bg-red-100 text-red-800 border border-red-200';
                } else {
                    className += 'bg-blue-100 text-blue-800 border border-blue-200';
                }

                resultDiv.className = className;
                resultDiv.innerHTML = message;
                resultDiv.classList.remove('hidden');
                resultDiv.classList.add('animate-fadeIn');
            }

            resetHWID() {
                const input = document.getElementById('hwidInput').value.trim();
                if (!input) {
                    this.showHwidResult('Please enter a license key or HWID', 'error');
                    return;
                }

                const keyData = this.keys.find(k => k.key === input || k.hwid === input);
                if (!keyData) {
                    this.showHwidResult('License key not found', 'error');
                    return;
                }

                keyData.hwid = null;
                keyData.hwidResets++;
                this.stats.hwidResets++;
                
                this.saveData();
                this.updateStats();
                this.showHwidResult(`HWID reset successfully for key: ${keyData.key}`, 'success');
                this.showToast('HWID reset completed');

                // Auto-hide after 3 seconds
                setTimeout(() => {
                    document.getElementById('hwidResult').classList.add('hidden');
                }, 3000);
            }

            checkHWID() {
                const input = document.getElementById('hwidInput').value.trim();
                if (!input) {
                    this.showHwidResult('Please enter a license key or HWID', 'error');
                    return;
                }

                const keyData = this.keys.find(k => k.key === input || k.hwid === input);
                if (!keyData) {
                    this.showHwidResult('License key not found', 'error');
                    return;
                }

                this.showHwidResult(
                    `Key: ${keyData.key}<br>
                    Current HWID: ${keyData.hwid || 'Not bound'}<br>
                    HWID Resets Used: ${keyData.hwidResets}<br>
                    Status: ${keyData.status.toUpperCase()}`,
                    'info'
                );

                // Auto-hide after 4 seconds
                setTimeout(() => {
                    document.getElementById('hwidResult').classList.add('hidden');
                }, 4000);
            }

            showHwidResult(message, type) {
                const resultDiv = document.getElementById('hwidResult');
                let className = 'p-3 rounded-md text-sm ';
                
                if (type === 'success') {
                    className += 'bg-green-100 text-green-800 border border-green-200';
                } else if (type === 'error') {
                    className += 'bg-red-100 text-red-800 border border-red-200';
                } else {
                    className += 'bg-blue-100 text-blue-800 border border-blue-200';
                }

                resultDiv.className = className;
                resultDiv.innerHTML = message;
                resultDiv.classList.remove('hidden');
                resultDiv.classList.add('animate-fadeIn');
            }

            removeAllKeys() {
                if (this.keys.length === 0) {
                    this.showToast('No keys to remove');
                    return;
                }

                if (confirm(`Are you sure you want to remove all ${this.keys.length} keys? This action cannot be undone.`)) {
                    this.keys = [];
                    this.stats = {
                        totalKeys: 0,
                        activeKeys: 0,
                        expiredKeys: 0,
                        hwidResets: 0
                    };
                    
                    this.saveData();
                    this.updateDisplay();
                    this.updateStats();
                    this.showToast('All keys removed successfully');
                }
            }

            removeKey(keyId) {
                const keyIndex = this.keys.findIndex(k => k.id === keyId);
                if (keyIndex === -1) return;

                const keyData = this.keys[keyIndex];
                this.keys.splice(keyIndex, 1);
                this.stats.totalKeys--;
                
                if (keyData.status === 'active') {
                    this.stats.activeKeys--;
                } else if (keyData.status === 'expired') {
                    this.stats.expiredKeys--;
                }

                this.saveData();
                this.updateDisplay();
                this.updateStats();
                this.showToast(`Key ${keyData.key} removed`);
            }

            updateDisplay() {
                const container = document.getElementById('keysContainer');
                
                if (this.keys.length === 0) {
                    container.innerHTML = '<p class="text-muted-foreground text-center py-8">No keys generated yet</p>';
                    return;
                }

                container.innerHTML = this.keys.slice(0, 10).map(key => {
                    let statusText = key.status.charAt(0).toUpperCase() + key.status.slice(1);
                    let statusClass = `status-${key.status}`;
                    let timeInfo = '';

                    if (key.status === 'unused') {
                        timeInfo = `Duration: ${key.duration} day(s)`;
                    } else if (key.status === 'active' && key.expiresAt) {
                        const now = new Date();
                        const expiry = new Date(key.expiresAt);
                        const timeLeft = Math.max(0, expiry - now);
                        const daysLeft = Math.ceil(timeLeft / (1000 * 60 * 60 * 24));
                        timeInfo = `${daysLeft} days left`;
                    } else if (key.status === 'expired') {
                        timeInfo = 'Expired';
                    }
                    
                    return `
                        <div class="p-3 bg-secondary/20 rounded-lg border animate-fadeIn">
                            <div class="flex justify-between items-start mb-1">
                                <div class="key-display text-sm font-mono font-bold text-primary cursor-pointer">${key.key}</div>
                                <button 
                                    onclick="licenseManager.removeKey(${key.id})"
                                    class="text-destructive hover:text-destructive/80 text-xs px-2 py-1 rounded border border-destructive/20 hover:bg-destructive/10">
                                    Remove
                                </button>
                            </div>
                            <div class="text-xs text-muted-foreground">
                                Status: <span class="${statusClass} font-medium">${statusText}</span>
                                ${timeInfo ? '• ' + timeInfo : ''}
                            </div>
                            <div class="text-xs text-muted-foreground">
                                Created: ${new Date(key.created).toLocaleDateString()}
                            </div>
                        </div>
                    `;
                }).join('');
            }

            updateStats() {
                // Recalculate stats based on current key statuses
                let unusedCount = 0;
                let activeCount = 0;
                let expiredCount = 0;

                this.keys.forEach(key => {
                    if (key.status === 'unused') {
                        unusedCount++;
                    } else if (key.status === 'active') {
                        // Check if key should be expired
                        if (key.expiresAt) {
                            const now = new Date();
                            const expiry = new Date(key.expiresAt);
                            if (now > expiry) {
                                key.status = 'expired';
                                expiredCount++;
                            } else {
                                activeCount++;
                            }
                        } else {
                            activeCount++;
                        }
                    } else if (key.status === 'expired') {
                        expiredCount++;
                    }
                });

                this.stats.activeKeys = activeCount;
                this.stats.expiredKeys = expiredCount;

                document.getElementById('totalKeys').textContent = this.stats.totalKeys;
                document.getElementById('activeKeys').textContent = this.stats.activeKeys;
                document.getElementById('expiredKeys').textContent = this.stats.expiredKeys;
                document.getElementById('hwidResets').textContent = this.stats.hwidResets;
            }

            showToast(message) {
                const toast = document.getElementById('toast');
                const toastMessage = document.getElementById('toastMessage');
                
                toastMessage.textContent = message;
                toast.classList.remove('translate-x-full');
                
                setTimeout(() => {
                    toast.classList.add('translate-x-full');
                }, 3000);
            }

            saveData() {
                localStorage.setItem('licenseKeys', JSON.stringify(this.keys));
                localStorage.setItem('licenseStats', JSON.stringify(this.stats));
            }

            // Method to simulate app usage (for testing - in real implementation this would be called by your app)
            activateKey(keyCode, hwid) {
                const keyData = this.keys.find(k => k.key === keyCode);
                if (!keyData) return { success: false, message: 'Key not found' };
                
                if (keyData.status === 'expired') {
                    return { success: false, message: 'Key has expired' };
                }
                
                if (keyData.status === 'unused') {
                    // First time activation
                    const now = new Date();
                    keyData.status = 'active';
                    keyData.activatedAt = now.toISOString();
                    keyData.expiresAt = new Date(now.getTime() + (keyData.duration * 24 * 60 * 60 * 1000)).toISOString();
                    keyData.hwid = hwid;
                    
                    this.saveData();
                    this.updateStats();
                    return { success: true, message: 'Key activated successfully' };
                }
                
                if (keyData.status === 'active') {
                    // Check HWID match
                    if (keyData.hwid && keyData.hwid !== hwid) {
                        return { success: false, message: 'HWID mismatch' };
                    }
                    
                    // Check if still valid
                    const now = new Date();
                    const expiry = new Date(keyData.expiresAt);
                    if (now > expiry) {
                        keyData.status = 'expired';
                        this.saveData();
                        this.updateStats();
                        return { success: false, message: 'Key has expired' };
                    }
                    
                    return { success: true, message: 'Key is valid and active' };
                }
                
                return { success: false, message: 'Invalid key status' };
            }
        }

        // Initialize the license manager when page loads
        let licenseManager;
        document.addEventListener('DOMContentLoaded', () => {
            licenseManager = new LicenseManager();
        });

        // Copy key functionality
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('key-display')) {
                navigator.clipboard.writeText(e.target.textContent).then(() => {
                    // Show temporary copy indicator
                    const original = e.target.textContent;
                    e.target.textContent = 'Copied!';
                    e.target.classList.add('text-green-600');
                    
                    setTimeout(() => {
                        e.target.textContent = original;
                        e.target.classList.remove('text-green-600');
                    }, 1000);
                });
            }
        });
    </script>
</body>
</html>
